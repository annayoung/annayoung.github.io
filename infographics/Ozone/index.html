<!DOCTYPE HTML>
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
</head>

<body style="background-color: rgb(58, 158, 153);">

<object id="svg-object" width="100%" height="100%" style="position: absolute" type="image/svg+xml" data="./Ozone1.svg">Your browser does not support SVG</object>

<script type="text/javascript">

var obj = document.getElementById("svg-object");
obj.addEventListener("load", function() {
	var object = obj.contentDocument;

	var balloon = object.getElementById("balloon");
	var buildings = object.getElementById("buildings");
	var front = object.getElementById("front-buildings");
	var factory = object.getElementById("factory");
	var stacks = object.getElementsByClassName("smoke-stack");
	var trees = object.getElementById("trees");
	var trees_hidden = object.getElementById("trees-person");
	var person = object.getElementById("person");
	var beach = object.getElementById("person+beach");
	var smog = object.getElementById("smog");

// hover over elements
	$(balloon).hover(function() {
		$(this).attr("fill", "#D1DE58");
	}, function() {
		$(this).attr("fill", "#FFFFFF");
	});
	$(buildings).hover(function() {
		$(front).attr("fill", "#D1DE58");
		$(factory).attr("fill", "#D1DE58");
		$(stacks).each(function() {
			$(this).attr("fill", "#D1DE58");
		});
	}, function() {
		$(front).attr("fill", "#FFFFFF");
		$(factory).attr("fill", "#FFFFFF");
		$(stacks).each(function() {
			$(this).attr("fill", "#FFFFFF");
		});
	});	
	$([trees, trees_hidden]).hover(function() {
		$(object.getElementsByClassName("tree")).each(function() {
			$(this).attr("fill", "#D1DE58");
		});
		$(object.getElementsByClassName("tree-gray")).each(function() {
			$(this).attr("fill", "#99a541");
		});
	}, function() {
		$(object.getElementsByClassName("tree")).each(function() {
			$(this).attr("fill", "#FFFFFF");
		});
		$(object.getElementsByClassName("tree-gray")).each(function() {
			$(this).attr("fill", "#D1D3D4");
		});
	});

	$(person).hover(function() {
		$(this).attr("fill", "#D1DE58");
	}, function() {
		$(this).attr("fill", "rgb(58, 158, 153)");
	});


	var seconds = 1; // animation time

// GO BACK BUTTON
	$(object.getElementById("go_back")).click(function() {
		$(person).attr("cursor", "pointer").attr("pointer-events", "auto");
		$(trees_hidden).attr("cursor", "pointer").attr("pointer-events", "auto");
		//$(object.getElementById("respiratory2")).fadeOut(200);
		$(object.getElementsByClassName("trees-hide")).show();
	});
	$(object.getElementById("go_back_cities")).click(function() {
		$(buildings).attr("cursor", "pointer").attr("pointer-events", "auto");
		$([trees, trees_hidden]).attr("cursor", "pointer").attr("pointer-events", "auto");
		$(smog).fadeIn(seconds*1000);
	});

// HIDE ELEMENTS OF FIRST PAGE	
	// balloon floats up
	$(balloon).append(createMotion(2*seconds, "person.click; buildings.click", "0,0", "0,-1600", "go_back.click; go_back_cities.click"));
	$(balloon).append(createMotion(2*seconds, "go_back.click; go_back_cities.click", "0,-1600", "0,0", "person.click; buildings.click"));	

// WHEN PERSON CLICKED
	personClicked(object, person, trees_hidden, balloon, beach, seconds);

// WHEN CITIES/FACTORY CLICKED
	citiesClicked(object, buildings, seconds, trees, person, trees_hidden, smog);

});

	function citiesClicked(object, buildings, seconds, trees, person, trees_hidden, smog) {
		$(buildings).click(function() {
			$([buildings, trees, trees_hidden]).attr("cursor", "auto").attr("pointer-events", "none");
			$(smog).fadeOut(seconds*1000);
		});

		$(object.getElementById("page1-text")).append(createMotion(seconds, "buildings.click;", "0,0", "2000,0", "go_back_cities.click"))
			.append(createMotion(seconds, "go_back_cities.click;", "2000,0", "0,0", "buildings.click"));
		$(person).append(createMotion(seconds, "buildings.click;", "0,0", "2000,0", "go_back_cities.click"))
			.append(createMotion(seconds, "go_back_cities.click;", "2000,0", "0,0", "buildings.click"));
		
		$(object.getElementById("sources-text")).append(createMotion(seconds, "buildings.click", "-1600,0", "0,0", "go_back_cities.click"))
			.append(createSet("visibility", "visible", "buildings.click", "go_back_cities.click + " + seconds + "s"))
			.append(createMotion(seconds, "go_back_cities.click", "0,0", "-1600,0", "buildings.click"));
		
	}


	function personClicked(object, person, trees_hidden, balloon, beach, seconds) {
		$(person).click(function() {
			$(person).attr("cursor", "auto").attr("pointer-events", "none");
			$(trees_hidden).attr("cursor", "auto").attr("pointer-events", "none");
		});
		
		// hide elements of page1
		$(object.getElementById("first")).append(createMotion(seconds, "person.click;", "0,0", "2000,0", "go_back.click"))
			.append(createMotion(seconds, "go_back.click", "2000,0", "0,0", "person.click;"));
		// make trees bigger
		$(object.getElementsByClassName("trees-hide")).hide();
		// make beach and person bigger
		$(beach).append(createTransform("scale", seconds, "person.click", "1", "1.25"))
			.append(createMotion(seconds, "person.click", "0,0", "-410,-200", "go_back.click"))
			.append(createTransform("scale", seconds, "go_back.click", "1.25", "1"))
			.append(createMotion(seconds, "go_back.click", "-410,-200", "0,0", "person.click"));

		$(object.getElementById("person-text")).append(createMotion(seconds, "person.click", "-1600,0", "0,0", "go_back.click"))
			.append(createSet("visibility", "visible", "person.click", "go_back.click + " + seconds + "s"));
		$(object.getElementById("draw-respiratory-line")).append(createSet("visibility", "visible", "person.click + " + (seconds/2) + "s", "go_back.click"));
		$(object.getElementById("draw-respiratory-line")).append(createAnimate("stroke-dashoffset", seconds/2, "person.click + " + (seconds) + "s", "440", "0", "go_back.click"));
		$(object.getElementById("respiratory-dropdown")).append(createSet("visibility", "visible", "person.click + " + (3/2.0*seconds) + "s", "go_back.click"));
		//$(object.getElementById("draw-respiratory-line-health")).append(createSet("visibility", "visible", "person.click + " + (seconds) + "s", false));
		//$(object.getElementById("draw-respiratory-line-health")).append(createAnimate("stroke-dashoffset", seconds, "person.click + " + (seconds) + "s", "440", "0", false));
		//$(object.getElementById("respiratory-dropdown-health")).append(createSet("visibility", "visible", "person.click + " + (2*seconds) + "s", false));
			// to go back to homepage:
		$(object.getElementById("person-text")).append(createMotion(seconds, "go_back.click", "0,0", "-1600,0", "person.click"));
		$(object.getElementById("draw-respiratory-line")).append(createAnimate("stroke-dashoffset", seconds, "go_back.click", "0", "440", "person.click"));
		
		$(object.getElementsByClassName("fade1")).each(function() {$(this).append(createSet("visibility", "visible", "person.click + " + seconds + "s", "go_back.click"));});
		$(object.getElementById("health-line2")).append(createAnimate("stroke-dashoffset", seconds*3, "person.click + " + (seconds) + "s", "150", "0", "go_back.click"));
		$(object.getElementById("health-line2")).append(createSet("visibility", "visible", "person.click + " + (seconds) + "s", "go_back.click"));
		$(object.getElementById("health-line2")).append(createSet("stroke-dasharray", "0", "person.click + " + (seconds + 0.25) + "s", "go_back.click"));

		$(object.getElementById("forward")).append(createSet("visibility", "visible", "person.click + " + (seconds) + "s", "forward.click; go_back.click"));
		$(object.getElementById("forward")).append(createSet("visibility", "visible", "closeHealth.click + " + (seconds) + "s; reverse_health.click + " + (seconds) + "s", "forward.click; go_back.click"));

		
		initializeHealthLine(object, seconds, 0);
		hideHealth(object, seconds, 0);

		initializeRespiratory(object, seconds, 0);
	}

	function initializeRespiratory(object, seconds, sec) {
		// open respiratory effects
		$(object.getElementById("respiratory-hide")).append(createAnimate("height", 1, "respiratory2.click; respiratory2health.click", "495", "0"));
		//$([object.getElementById("respiratory2"), object.getElementById("respiratory2health")]).click(function() {
		$(object.getElementById("respiratory2")).click(function() {	
			$(object.getElementById("respiratory2")).fadeOut(200);
			//$(object.getElementById("respiratory2-health")).fadeOut(200);
			$(object.getElementById("respiratory-close")).fadeIn(200);
			$(object.getElementById("respiratory-info")).show();
		});

		// close respiratory effects
		$(object.getElementById("respiratory-close")).click(function() {
			$(object.getElementById("respiratory2")).fadeIn(200);
			//$(object.getElementById("respiratory2-health")).fadeIn(200);
			$(object.getElementById("respiratory-close")).fadeOut(200);
			$(object.getElementById("respiratory-info")).fadeOut(200);
		});
	}

	function initializeHealthLine(object, seconds, sec) {
		$(object.getElementById("health-line")).append(createSet("visibility", "visible", "forward.click", "closeHealth.click + "+ (seconds*2) + "s"));
		$(object.getElementById("health-line")).append(createAnimate("stroke-dashoffset", seconds*2, "forward.click ", "1000", "0"));
		$(object.getElementById("health-line")).append(createAnimate("stroke-dashoffset", seconds, "reverse_health.click; closeHealth.click", "0", "1000"));

		sec += seconds*2 / 5.5;
		$(object.getElementById("small-lines1")).append(createAnimate("stroke-dashoffset", seconds/2, "forward.click + " + sec + "s", "50", "0", false)).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s", false));
		$(object.getElementsByClassName("fade2")).each(function() {$(this).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s", false));});
		
		sec += seconds*2 / 5.0;
		$(object.getElementById("small-lines2")).append(createAnimate("stroke-dashoffset", seconds/2, "forward.click + " + sec + "s", "50", "0", false)).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s", false));
		$(object.getElementsByClassName("fade3")).each(function() {$(this).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s", false));});
		
		sec += seconds*2 / 5.0;
		$(object.getElementById("small-lines3")).append(createAnimate("stroke-dashoffset", seconds/2, "forward.click + " + sec + "s", "50", "0", false)).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s", false));
		$(object.getElementsByClassName("fade4")).each(function() {$(this).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s", false));});
		
		sec += seconds*2 / 5.0;
		$(object.getElementById("small-lines4")).append(createAnimate("stroke-dashoffset", seconds/2, "forward.click + " + sec + "s", "50", "0", false)).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s", false));
		$(object.getElementsByClassName("fade5")).each(function() {$(this).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s", false));});
		
		sec += seconds*2 / 5.0;
		$(object.getElementsByClassName("fade6")).each(function() {$(this).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s", false));});
	

		/*$([object.getElementById("reverse_health"), $(object.getElementById("closeHealth"))]).click(function() {
			$(object.getElementById("closeHealth")).hide();
		});
		$(object.getElementById("forward")).click(function() {
			$(object.getElementById("closeHealth")).delay(seconds*1000).show(0);
		});*/
	}

	function hideHealth(object, seconds, sec) {
		seconds /= 2;
		sec = 2*seconds * 0.9818;

		sec -= seconds*2 / 5.5;
		$(object.getElementById("small-lines1")).append(createAnimate("stroke-dashoffset", seconds/2, "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s", "50", "0", false)).append(createSet("visibility", "hidden", "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade2")).each(function() {$(this).append(createSet("visibility", "hidden", "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s", false));});
		
		sec -= seconds*2 / 5.0;
		$(object.getElementById("small-lines2")).append(createAnimate("stroke-dashoffset", seconds/2, "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s", "50", "0", false)).append(createSet("visibility", "hidden", "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade3")).each(function() {$(this).append(createSet("visibility", "hidden", "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s", false));});
		
		sec -= seconds*2 / 5.0;
		$(object.getElementById("small-lines3")).append(createAnimate("stroke-dashoffset", seconds/2, "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s", "50", "0", false)).append(createSet("visibility", "hidden", "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade4")).each(function() {$(this).append(createSet("visibility", "hidden", "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s", false));});
		
		sec -= seconds*2 / 5.0;
		$(object.getElementById("small-lines4")).append(createAnimate("stroke-dashoffset", seconds/2, "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s", "50", "0", false)).append(createSet("visibility", "hidden", "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade5")).each(function() {$(this).append(createSet("visibility", "hidden", "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s", false));});
		
		sec -= seconds*2 / 5.0;
		$(object.getElementsByClassName("fade6")).each(function() {$(this).append(createSet("visibility", "hidden", "reverse_health.click + " + (sec) + "s; closeHealth.click + " + (sec) + "s", false));});
	}


		function createMotion(seconds, begin, from, to, end) {
		var animation = document.createElementNS("http://www.w3.org/2000/svg","animateMotion");
		animation.setAttribute("dur", seconds + "s");
		animation.setAttribute("repeatCount", "1");
		animation.setAttribute("begin", begin);
		animation.setAttribute("from", from);
		animation.setAttribute("to", to);
		animation.setAttribute("fill", "freeze");
		if (end != false)
			animation.setAttribute("end", end);
		return animation;
	}
	function createTransform(type, seconds, begin, from, to) {
		var scale = document.createElementNS("http://www.w3.org/2000/svg","animateTransform");
		scale.setAttribute("attributeName", "transform");
		scale.setAttribute("attributeType", "XML");
		scale.setAttribute("type", type);
		scale.setAttribute("dur", seconds + "s");
		scale.setAttribute("repeatCount", "1");
		scale.setAttribute("begin", begin);
		scale.setAttribute("from", from);
		scale.setAttribute("to", to);
		scale.setAttribute("fill", "freeze");
		return scale;
	}
	function createSet(name, to, begin, end) {
		var set = document.createElementNS("http://www.w3.org/2000/svg","set");
		set.setAttribute("attributeName", name);
		set.setAttribute("attributeType", "XML");
		set.setAttribute("to", to);
		set.setAttribute("begin", begin);
		if (end != false)
			set.setAttribute("end", end);
		return set;
	}
	function createAnimate(name, seconds, begin, from, to, id) {
		var animation = document.createElementNS("http://www.w3.org/2000/svg","animate");
		animation.setAttribute("dur", seconds + "s");
		animation.setAttribute("attributeName", name);
		animation.setAttribute("attributeType", "XML");
		animation.setAttribute("repeatCount", "1");
		animation.setAttribute("begin", begin);
		animation.setAttribute("from", from);
		animation.setAttribute("to", to);
		animation.setAttribute("fill", "freeze");
		if (id)
			animation.setAttribute("id", id);
		return animation;
	}

</script>
</body>
</html>