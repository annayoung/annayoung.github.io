<!DOCTYPE HTML>
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
</head>

<body style="background-color: rgb(58, 158, 153);">

<object id="svg-object" width="100%" height="100%" style="position: absolute" type="image/svg+xml" data="./Ozone1.svg">Your browser does not support SVG</object>

<script type="text/javascript">

var obj = document.getElementById("svg-object");
obj.addEventListener("load", function() {
	var object = obj.contentDocument;

	var balloon = object.getElementById("balloon");
	var buildings = object.getElementById("buildings");
	var front = object.getElementById("front-buildings");
	var factory = object.getElementById("factory");
	var stacks = object.getElementsByClassName("smoke-stack");
	var trees = object.getElementById("trees");
	var trees_hidden = object.getElementById("trees-person");
	var person = object.getElementById("person");
	var beach = object.getElementById("person+beach");

	var page = "home";
// go back button
	var back = object.getElementById("go-back");
	$(back).click(function() {
		if (page === "person")
		{
			$(person).attr("cursor", "pointer");
			$(person).attr("pointer-events", "auto");

			// show elements of page1
			$(object.getElementById("first")).append(createMotion("4s", "0s", "0,0", "-2000,0", false));

			// balloon floats down
			$(balloon).append(createMotion("9s", "0s", "0,0", "0,1600", false));

			// make beach and person bigger
			$(beach).append(createTransform("scale", "4s", "0s", "1.25", "1"));
			$(beach).append(createMotion("4s", "0s", "0,0", "410,200", false));
			$(object.getElementsByClassName("trees-hide")).show();
		}
		page = "home";
	});

// hover over elements
	$(balloon).hover(function() {
		$(this).attr("fill", "#D1DE58");
	}, function() {
		$(this).attr("fill", "#FFFFFF");
	});
	$(buildings).hover(function() {
		$(front).attr("fill", "#D1DE58");
		$(factory).attr("fill", "#D1DE58");
		$(stacks).each(function() {
			$(this).attr("fill", "#D1DE58");
		});
	}, function() {
		$(front).attr("fill", "#FFFFFF");
		$(factory).attr("fill", "#FFFFFF");
		$(stacks).each(function() {
			$(this).attr("fill", "#FFFFFF");
		});
	});	
	$([trees, trees_hidden]).hover(function() {
		$(object.getElementsByClassName("tree")).each(function() {
			$(this).attr("fill", "#D1DE58");
		});
		$(object.getElementsByClassName("tree-gray")).each(function() {
			$(this).attr("fill", "#99a541");
		});
	}, function() {
		$(object.getElementsByClassName("tree")).each(function() {
			$(this).attr("fill", "#FFFFFF");
		});
		$(object.getElementsByClassName("tree-gray")).each(function() {
			$(this).attr("fill", "#D1D3D4");
		});
	});

	$(person).hover(function() {
		$(this).attr("fill", "#D1DE58");
	}, function() {
		$(this).attr("fill", "rgb(58, 158, 153)");
	});

// WHEN PERSON CLICKED
	window.healthShown = false;
	personClicked(object, person, trees_hidden, balloon, beach);

});


	function createMotion(seconds, begin, from, to, id) {
		var animation = document.createElementNS("http://www.w3.org/2000/svg","animateMotion");
		animation.setAttribute("dur", seconds + "s");
		animation.setAttribute("repeatCount", "1");
		animation.setAttribute("begin", begin);
		animation.setAttribute("from", from);
		animation.setAttribute("to", to);
		animation.setAttribute("fill", "freeze");
		if (id)
			animation.setAttribute("id", id);
		return animation;
	}
	function createTransform(type, seconds, begin, from, to) {
		var scale = document.createElementNS("http://www.w3.org/2000/svg","animateTransform");
		scale.setAttribute("attributeName", "transform");
		scale.setAttribute("attributeType", "XML");
		scale.setAttribute("type", type);
		scale.setAttribute("dur", seconds + "s");
		scale.setAttribute("repeatCount", "1");
		scale.setAttribute("begin", begin);
		scale.setAttribute("from", from);
		scale.setAttribute("to", to);
		scale.setAttribute("fill", "freeze");
		return scale;
	}
	function createSet(name, to, begin) {
		var set = document.createElementNS("http://www.w3.org/2000/svg","set");
		set.setAttribute("attributeName", name);
		set.setAttribute("attributeType", "XML");
		set.setAttribute("to", to);
		set.setAttribute("begin", begin);
		return set;
	}
	function createAnimate(name, seconds, begin, from, to, id) {
		var animation = document.createElementNS("http://www.w3.org/2000/svg","animate");
		animation.setAttribute("dur", seconds + "s");
		animation.setAttribute("attributeName", name);
		animation.setAttribute("attributeType", "XML");
		animation.setAttribute("repeatCount", "1");
		animation.setAttribute("begin", begin);
		animation.setAttribute("from", from);
		animation.setAttribute("to", to);
		animation.setAttribute("fill", "freeze");
		if (id)
			animation.setAttribute("id", id);
		return animation;
	}


	function personClicked(object, person, trees_hidden, balloon, beach) {
		$(person).click(function() {
			page = "person";
			$(person).attr("cursor", "auto");
			$(person).attr("pointer-events", "none");
			$(trees_hidden).attr("cursor", "auto");
			$(trees_hidden).attr("pointer-events", "none");
			window.healthShown = true;
		});
		var seconds = 1;

		// make trees bigger
		$(object.getElementsByClassName("trees-hide")).hide();
		// hide elements of page1
		$(object.getElementById("first")).append(createMotion(seconds, "person.click", "0,0", "2000,0", false));
		// balloon floats up
		$(balloon).append(createMotion(2*seconds, "person.click", "0,0", "0,-1600", false));
		// make beach and person bigger
		$(beach).append(createTransform("scale", seconds, "person.click", "1", "1.25"));
		$(beach).append(createMotion(seconds, "person.click", "0,0", "-410,-200", false));

		$(object.getElementById("person-text")).append(createMotion(seconds, "person.click", "-1000,0", "0,0", "text-move"));
		$(object.getElementById("person-text")).append(createSet("visibility", "visible", "person.click"));
		$(object.getElementById("draw-respiratory-line")).append(createSet("visibility", "visible", "person.click + " + (seconds) + "s"));
		$(object.getElementById("draw-respiratory-line")).append(createAnimate("stroke-dashoffset", seconds, "person.click + " + (seconds) + "s", "440", "0", false));
		$(object.getElementById("respiratory-dropdown")).append(createSet("visibility", "visible", "person.click + " + (2*seconds) + "s"));

		$(object.getElementsByClassName("fade1")).each(function() {$(this).append(createSet("visibility", "visible", "person.click + " + seconds + "s"));});
		$(object.getElementById("health-line2")).append(createAnimate("stroke-dashoffset", seconds*3, "person.click + " + (seconds) + "s", "150", "0", false));
		$(object.getElementById("health-line2")).append(createSet("visibility", "visible", "person.click + " + (seconds) + "s"));
		
		var set = document.createElementNS("http://www.w3.org/2000/svg","set");
		set.setAttribute("attributeName", "visibility");
		set.setAttribute("attributeType", "XML");
		set.setAttribute("to", "visible");
		set.setAttribute("begin", "person.click + " + (seconds) + "s; logo.click; reverse-health.click + " + (2*seconds-0.4) + "s; reverse2.click+ " + (2*seconds-0.4) + "s; reverse3.click+ " + (2*seconds-0.4) + "s");
		set.setAttribute("end", "forward.click");
		$(object.getElementById("forward")).append(set);

		$(object.getElementById("health-line2")).append(createSet("stroke-dasharray", "0", "person.click + " + (seconds + 0.25) + "s"));

		$(object.getElementById("health-line")).append(createSet("visibility", "visible", "forward.click"));
		$(object.getElementById("health-line")).append(createAnimate("stroke-dashoffset", seconds*2, "forward.click ", "1000", "0"));
		$(object.getElementById("health-line")).append(createAnimate("stroke-dashoffset", seconds*2, "reverse-health.click; reverse2.click; reverse3.click", "0", "1000"));
		
		initializeHealthLine(object, seconds, 0);
		hideHealth(object, seconds, 0);
	}

	function initializeHealthLine(object, seconds, sec) {
		sec += seconds*2 / 5.5;
		$(object.getElementById("small-lines1")).append(createAnimate("stroke-dashoffset", seconds/2, "forward.click + " + sec + "s", "50", "0", false)).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade2")).each(function() {$(this).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s"));});
		
		sec += seconds*2 / 5.0;
		$(object.getElementById("small-lines2")).append(createAnimate("stroke-dashoffset", seconds/2, "forward.click + " + sec + "s", "50", "0", false)).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade3")).each(function() {$(this).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s"));});
		
		sec += seconds*2 / 5.0;
		$(object.getElementById("small-lines3")).append(createAnimate("stroke-dashoffset", seconds/2, "forward.click + " + sec + "s", "50", "0", false)).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade4")).each(function() {$(this).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s"));});
		
		sec += seconds*2 / 5.0;
		$(object.getElementById("small-lines4")).append(createAnimate("stroke-dashoffset", seconds/2, "forward.click + " + sec + "s", "50", "0", false)).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade5")).each(function() {$(this).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s"));});
		
		sec += seconds*2 / 5.0;
		$(object.getElementsByClassName("fade6")).each(function() {$(this).append(createSet("visibility", "visible", "forward.click + " + (sec) + "s"));});
	}

	function hideHealth(object, seconds, sec) {
		sec = 2*seconds * 0.9818;

		sec -= seconds*2 / 5.5;
		$(object.getElementById("small-lines1")).append(createAnimate("stroke-dashoffset", seconds/2, "reverse-health.click + " + (sec) + "s", "50", "0", false)).append(createSet("visibility", "hidden", "reverse-health.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade2")).each(function() {$(this).append(createSet("visibility", "hidden", "reverse-health.click + " + (sec) + "s"));});
		
		sec -= seconds*2 / 5.0;
		$(object.getElementById("small-lines2")).append(createAnimate("stroke-dashoffset", seconds/2, "reverse-health.click + " + (sec) + "s", "50", "0", false)).append(createSet("visibility", "hidden", "reverse-health.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade3")).each(function() {$(this).append(createSet("visibility", "hidden", "reverse-health.click + " + (sec) + "s"));});
		
		sec -= seconds*2 / 5.0;
		$(object.getElementById("small-lines3")).append(createAnimate("stroke-dashoffset", seconds/2, "reverse-health.click + " + (sec) + "s", "50", "0", false)).append(createSet("visibility", "hidden", "reverse-health.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade4")).each(function() {$(this).append(createSet("visibility", "hidden", "reverse-health.click + " + (sec) + "s"));});
		
		sec -= seconds*2 / 5.0;
		$(object.getElementById("small-lines4")).append(createAnimate("stroke-dashoffset", seconds/2, "reverse-health.click + " + (sec) + "s", "50", "0", false)).append(createSet("visibility", "hidden", "reverse-health.click + " + (sec) + "s"));
		$(object.getElementsByClassName("fade5")).each(function() {$(this).append(createSet("visibility", "hidden", "reverse-health.click + " + (sec) + "s"));});
		
		sec -= seconds*2 / 5.0;
		$(object.getElementsByClassName("fade6")).each(function() {$(this).append(createSet("visibility", "hidden", "reverse-health.click + " + (sec) + "s"));});
	}


</script>
</body>
</html>